<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="biz.tech.mapif.ps.PGPS0020Mapper">

	 <sql id="dynamicWhereSql"> 
     <trim>
        <if test="sel_target_year != null and sel_target_year != '' ">
			AND STDYY_DO=#{sel_target_year}
		</if>
		<if test="searchCondition != null and searchCondition != '' ">
		  		and ENTCLS=#{searchCondition}
		</if>
		<if test="multiSelectGrid1 != null and multiSelectGrid1 != '' and induty_select != '' ">
			<if test="multiSelectGrid1 == 'UT00' "></if>
			<if test="multiSelectGrid1 == 'UT01' ">AND SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C'</if>
			<if test="multiSelectGrid1 == 'UT02' ">AND SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C'</if>
		</if>
     </trim>
     </sql>
     
     <sql id="dynamicWhere">
     <trim>
        <if test="sel_target_year != null and sel_target_year != '' ">
			AND STDYY=#{sel_target_year}
		</if>
		<if test="searchCondition != null and searchCondition != '' ">
			<if test="searchCondition == 'EA1' "></if>
			<if test="searchCondition == 'EA2' ">AND A.MNGMT_STLE LIKE '%기업(일반)%'</if>
			<if test="searchCondition == 'EA3' ">AND A.MNGMT_STLE LIKE '%관계기업%'</if>
			<if test="searchCondition == 'EA4' ">AND A.MNGMT_STLE LIKE '%후보기업%'</if>
			<if test="searchCondition == 'EA5' ">AND A.MNGMT_STLE LIKE '%가젤형%'</if>
		</if>
		<if test="multiSelectGrid != null and multiSelectGrid != '' ">
			${multiSelectGrid}
		</if>
		
		<if test="capl1 != null and capl1 != 0 and capl2 != null and capl2 != 0">
			AND (CAPL >= #{capl1} and CAPL <![CDATA[<=]]> #{capl2})
		</if>
		<if test="selng_am1 != null and selng_am1 != 0 and selng_am2 != null and selng_am2 != 0">
			AND (SELNG_AM >= #{selng_am1} and SELNG_AM <![CDATA[<=]]> #{selng_am2})
		</if>
		<if test="xport_am_kr1 != null and selng_am1 != 0 and xport_am_kr2 != null and xport_am_kr2 != 0">
			AND (XPORT_AM_KR >= #{xport_am_kr1} and XPORT_AM_KR <![CDATA[<=]]> #{xport_am_kr2})
		</if>
		<if test="bsn_profit1 != null and bsn_profit1 != 0 and bsn_profit2 != null and bsn_profit2 != 0">
			AND (BSN_PROFIT >= #{bsn_profit1} and BSN_PROFIT <![CDATA[<=]]> #{bsn_profit2})
		</if>
		<if test="thstrm_ntpf1 != null and thstrm_ntpf1 != 0 and thstrm_ntpf2 != null and thstrm_ntpf2 != 0">
			AND (THSTRM_NTPF >= #{thstrm_ntpf1} and THSTRM_NTPF <![CDATA[<=]]> #{thstrm_ntpf2})
		</if>
		<if test="rsrch_devlop_ct1 != null and rsrch_devlop_ct1 != 0 and rsrch_devlop_ct2 != null and rsrch_devlop_ct2 != 0">
			AND (RSRCH_DEVLOP_CT >= #{rsrch_devlop_ct1} and RSRCH_DEVLOP_CT <![CDATA[<=]]> #{rsrch_devlop_ct2})
		</if>
		<if test="ordtm_labrr_co1 != null and ordtm_labrr_co1 != 0 and ordtm_labrr_co2 != null and ordtm_labrr_co2 != 0">
			AND (ORDTM_LABRR_CO >= #{ordtm_labrr_co1} and ORDTM_LABRR_CO <![CDATA[<=]]> #{ordtm_labrr_co2})
		</if>
     </trim>
     </sql>
     
     <!-- 구간별현황 지표선택 시 변경될 테이블 목록 -->
     <sql id="sectionIdxOutTB">
     <trim>
        <if test="sel_index_type == null or sel_index_type == 'A'.toString() ">
	         IFNULL(SUM(L.SCTN1), 0) AS SCTN1
			, IFNULL(SUM(L.SCTN2), 0) AS SCTN2
			, IFNULL(SUM(L.SCTN3), 0) AS SCTN3
			, IFNULL(SUM(L.SCTN4), 0) AS SCTN4
			, IFNULL(SUM(L.SCTN5), 0) AS SCTN5
			, IFNULL(SUM(L.SCTN6), 0) AS SCTN6
			, IFNULL(SUM(L.SCTN7), 0) AS SCTN7
			, IFNULL(SUM(SCTN1)+SUM(SCTN2)+SUM(SCTN3)+SUM(SCTN4)+SUM(SCTN5)+SUM(SCTN6)+SUM(SCTN7), 0) as SCTN8
		</if>
		<if test="sel_index_type == 'B'.toString() ">
			 IFNULL(SUM(L.SCTN1), 0) AS SCTN1
			, IFNULL(SUM(L.SCTN2), 0) AS SCTN2
			, IFNULL(SUM(L.SCTN3), 0) AS SCTN3
			, IFNULL(SUM(L.SCTN4), 0) AS SCTN4
			, IFNULL(SUM(L.SCTN5), 0) AS SCTN5
			, IFNULL(SUM(L.SCTN6), 0) AS SCTN6
			, IFNULL(SUM(L.SCTN7), 0) AS SCTN7
			, IFNULL(SUM(L.SCTN8), 0) AS SCTN8
			, IFNULL(SUM(SCTN1)+SUM(SCTN2)+SUM(SCTN3)+SUM(SCTN4)+SUM(SCTN5)+SUM(SCTN6)+SUM(SCTN7)+SUM(SCTN8), 0) as SCTN9
		</if>
		<if test="sel_index_type == 'C'.toString() ">
			 IFNULL(SUM(L.SCTN1), 0) AS SCTN1
			, IFNULL(SUM(L.SCTN2), 0) AS SCTN2
			, IFNULL(SUM(L.SCTN3), 0) AS SCTN3
			, IFNULL(SUM(L.SCTN4), 0) AS SCTN4
			, IFNULL(SUM(L.SCTN5), 0) AS SCTN5
			, IFNULL(SUM(L.SCTN6), 0) AS SCTN6
			, IFNULL(SUM(L.SCTN7), 0) AS SCTN7
			, IFNULL(SUM(L.SCTN8), 0) AS SCTN8
			, IFNULL(SUM(SCTN1)+SUM(SCTN2)+SUM(SCTN3)+SUM(SCTN4)+SUM(SCTN5)+SUM(SCTN6)+SUM(SCTN7)+SUM(SCTN8), 0) as SCTN9
		</if>
		<if test="sel_index_type == 'D'.toString() ">
			 IFNULL(SUM(L.SCTN1), 0) AS SCTN1
			, IFNULL(SUM(L.SCTN2), 0) AS SCTN2
			, IFNULL(SUM(L.SCTN3), 0) AS SCTN3
			, IFNULL(SUM(L.SCTN4), 0) AS SCTN4
			, IFNULL(SUM(L.SCTN5), 0) AS SCTN5
			, IFNULL(SUM(L.SCTN6), 0) AS SCTN6
			, IFNULL(SUM(SCTN1)+SUM(SCTN2)+SUM(SCTN3)+SUM(SCTN4)+SUM(SCTN5)+SUM(SCTN6), 0) as SCTN7
		</if>
		<if test="sel_index_type == 'E'.toString() ">
			 IFNULL(SUM(L.SCTN1), 0) AS SCTN1
			, IFNULL(SUM(L.SCTN2), 0) AS SCTN2
			, IFNULL(SUM(L.SCTN3), 0) AS SCTN3
			, IFNULL(SUM(L.SCTN4), 0) AS SCTN4
			, IFNULL(SUM(L.SCTN5), 0) AS SCTN5
			, IFNULL(SUM(L.SCTN6), 0) AS SCTN6
			, IFNULL(SUM(SCTN1)+SUM(SCTN2)+SUM(SCTN3)+SUM(SCTN4)+SUM(SCTN5)+SUM(SCTN6), 0) as SCTN7
		</if>
		<if test="sel_index_type == 'F'.toString() ">
			ROUND(IFNULL(SUM(SCTN1_1) / SUM(SCTN1), 0), 0) AS SCTN1
			,ROUND(IFNULL(SUM(SCTN2_1) / SUM(SCTN2), 0), 0) AS SCTN2
			,ROUND(IFNULL(SUM(SCTN3_1) / SUM(SCTN3), 0), 0) AS SCTN3
			,ROUND(IFNULL(SUM(SCTN4_1) / SUM(SCTN4), 0), 0) AS SCTN4
			,ROUND(IFNULL(SUM(SCTN5_1) / SUM(SCTN5), 0), 0) AS SCTN5
			,ROUND(IFNULL(SUM(SCTN6_1) / SUM(SCTN6), 0), 0) AS SCTN6
			,ROUND(IFNULL(SUM(SCTN7_1) / SUM(SCTN7), 0), 0) AS SCTN7
			,ROUND(IFNULL(SUM(SCTN8_1) / SUM(SCTN8), 0), 0) AS SCTN8
			,IFNULL(SUM(SCTN1_1+SCTN2_1+SCTN3_1+SCTN4_1+SCTN5_1+SCTN6_1+SCTN7_1+SCTN8_1) / SUM(SCTN1+SCTN2+SCTN3+SCTN4+SCTN5+SCTN6+SCTN7+SCTN8), 0) as SCTN9
		</if>
     </trim>
     </sql>
     
     <!-- 구간별현황 지표선택 시 변경될 테이블 목록 -->
     <sql id="sectionIdxInTB">
     <trim>
        <if test="sel_index_type == null or sel_index_type == 'A'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6,
			SCTN.SCTN7
			FROM STS_RND_SCTN SCTN
		</if>
		<if test="sel_index_type == 'B'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6,
			SCTN.SCTN7,
			SCTN.SCTN8
			FROM STS_INDUTY_SCTN SCTN
		</if>
		<if test="sel_index_type == 'C'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6,
			SCTN.SCTN7,
			SCTN.SCTN8
			FROM STS_XPORT_SCTN SCTN
		</if>
		<if test="sel_index_type == 'D'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6
			FROM STS_LABRR_SCTN SCTN
		</if>
		<if test="sel_index_type == 'E'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6
			FROM STS_CORAGE_SCTN SCTN
		</if>
		<if test="sel_index_type == 'F'.toString() ">
			SCTN.SCTN1,
			SCTN.SCTN2,
			SCTN.SCTN3,
			SCTN.SCTN4,
			SCTN.SCTN5,
			SCTN.SCTN6,
			SCTN.SCTN7,
			SCTN.SCTN8,
			SCTN.SCTN1_1,
			SCTN.SCTN2_1,
			SCTN.SCTN3_1,
			SCTN.SCTN4_1,
			SCTN.SCTN5_1,
			SCTN.SCTN6_1,
			SCTN.SCTN7_1,
			SCTN.SCTN8_1
			FROM STS_SELNG_RND_SCTN SCTN
		</if>
     </trim>
     </sql>
     
	 <!-- 테마별업종 조회 -->
	<select id="indutyCd" resultType="MAP">
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.indutyCd */ 
	a.MANAGE_SN
	, DTLCLFC_NO
	, DTLCLFC_NM
	, group_concat(INDUTY_CODE separator ',') as INDUTY_CODE
	from TB_THEMA_MNG a, (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, INDUTY_CODE
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	) d
	where a.MANAGE_SN = d.MANAGE_SN
	and a.MANAGE_SN=1
	AND SUBSTRING(INDUTY_CODE, 1, 1) = 'C'
	group by DTLCLFC_NM
	UNION
	select a.MANAGE_SN
	, DTLCLFC_NO
	, DTLCLFC_NM
	, group_concat(INDUTY_CODE separator ',') as INDUTY_CODE
	from TB_THEMA_MNG a, (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, INDUTY_CODE
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	) d
	where a.MANAGE_SN = d.MANAGE_SN
	and a.MANAGE_SN=1
	AND SUBSTRING(INDUTY_CODE, 1, 1) != 'C'
	group by DTLCLFC_NM
	ORDER BY DTLCLFC_NO
	</select>
	
	<select id="indutyCd2" resultType="MAP">
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.indutyCd2 */ 
	a.MANAGE_SN
	, DTLCLFC_NO
	, DTLCLFC_NM
	, group_concat(INDUTY_CODE separator ',') as INDUTY_CODE
	from TB_THEMA_MNG a, (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, INDUTY_CODE
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	) d
	where a.MANAGE_SN = d.MANAGE_SN
	and a.MANAGE_SN=1
	AND SUBSTRING(INDUTY_CODE, 1, 1) = 'C'
	group by DTLCLFC_NM
	ORDER BY DTLCLFC_NO
	</select>
	
	<select id="indutyCd3" resultType="MAP">
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.indutyCd3 */ 
	a.MANAGE_SN
	, DTLCLFC_NO
	, DTLCLFC_NM
	, group_concat(INDUTY_CODE separator ',') as INDUTY_CODE
	from TB_THEMA_MNG a, (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, INDUTY_CODE
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	) d
	where a.MANAGE_SN = d.MANAGE_SN
	and a.MANAGE_SN=1
	AND SUBSTRING(INDUTY_CODE, 1, 1) != 'C'
	group by DTLCLFC_NM
	ORDER BY DTLCLFC_NO
	</select>
	
	
	<!-- 지역코드 조회(시도별)-->
	<select id="findCodesCity" resultType="MAP">
	SELECT 	/* ProgramID=biz.tech.mapif.cm.CodeMapper.findCodesCity */
	AREA_CODE
	, UPPER_CODE
	, `DIV`
	, AREA_NM
	, ABRV
	from TB_AREA_DIV
	where `DIV` = 2
	and AREA_CODE != 'D99'
	</select>
     
	<!-- 지역(본사기준) - 구/군 -->
	<select id="findAreaSelect" resultType="Map">
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.findAreaSelect */
	AREA_CODE
	, UPPER_CODE
	, `DIV`
	, AREA_NM
	, ABRV
	from TB_AREA_DIV
	where `DIV` = 3
	</select>

	<!-- 주요지표-현황 목록 개수 조회-->
	<select id="findTotalIdxInfoRowCnt" resultType="int">
	SELECT 	/* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.findTotalIdxInfoRowCnt */
	    COUNT(*)
	from TB_ENTPRS_INFO A
	where 1=1
	  <!-- 검색조건 시작 -->
		<include refid="dynamicWhere"/>
	  <!-- 검색조건 끝 -->
	</select>
	
	<!-- 주요지표-현황 목록 조회 -->
	<select id="idxList" resultType="Map">
	SELECT /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.idxList */  
	STDYY_DO
	, K.AREA_CODE
	, K.UPPER_CODE
	, K.AREA_NM
	, K.ABRV
	<if test="sel_area == 'A'.toString() ">
	, K.AREA_NM AS AREA1
	</if>
	<if test="sel_area == 'C'.toString() ">
	, K.ABRV AS AREA1
	</if>
	, K.INDUTY_CODE
	, K.KOREAN_NM
	, K.DTLCLFC_NO
	, K.TEMA_CODE
	, K.INDUTY_GROUP
	, K.DTLCLFC_NM
	, K.INDUTY_GUBUN
	<if test="induty_select == 'I'.toString() ">
	, K.INDUTY_GUBUN as COL1
	</if>
	<if test="induty_select == 'T'.toString() ">
	, K.DTLCLFC_NM as COL1
	</if>
	<if test="induty_select == 'D'.toString() ">
	, K.KOREAN_NM as COL1
	</if>
	, IFNULL(ROUND(SUM(ENTRPRS_CO),0),0) AS ENTRPRS_CO_SUM
	, IFNULL(ROUND(SUM(SELNG_AM)/1000000000,0),0) AS SELNG_AM_SUM
	, IFNULL(ROUND(SUM(BSN_PROFIT)/100000,0),0) AS BSN_PROFIT_SUM
	, IFNULL(ROUND(SUM(XPORT_AM_WON)/100000,0),0) AS XPORT_AM_WON_SUM
	, IFNULL(ROUND(SUM(ORDTM_LABRR_CO),0),0) AS ORDTM_LABRR_CO_SUM
	, IFNULL(ROUND(SUM(RSRCH_DEVLOP_CT) / SUM(SELNG_AM),2),0) AS RSRCH_DEVLOP_CT_SUM
	, IFNULL(ROUND(SUM(THSTRM_NTPF)/100000,0),0) AS THSTRM_NTPF_SUM
	, IFNULL(ROUND(SUM(SELNG_AM) / SUM(ENTRPRS_CO)/100000),0) as SELNG_AM
	, IFNULL(ROUND(SUM(BSN_PROFIT) / SUM(ENTRPRS_CO)/100000,0),0) as BSN_PROFIT
	, IFNULL(ROUND(SUM(XPORT_AM_WON) / SUM(ENTRPRS_CO)/100000,0),0) as XPORT_AM_WON
	, IFNULL(ROUND(SUM(ORDTM_LABRR_CO) / SUM(ENTRPRS_CO),0),0) as ORDTM_LABRR_CO
	, IFNULL(ROUND((SUM(RSRCH_DEVLOP_CT) / SUM(ENTRPRS_CO)) / (SUM(SELNG_AM) / SUM(ENTRPRS_CO)),2),0) as RSRCH_DEVLOP_CT
	, IFNULL(ROUND(SUM(THSTRM_NTPF) / SUM(ENTRPRS_CO)/100000,0),0) as THSTRM_NTPF
	, IFNULL(ROUND(SUM(CORAGE) / SUM(ENTRPRS_CO),0),0) AS AVRG_CORAGE
	FROM (
	  select 
	  AREA_CODE, UPPER_CODE, AREA_NM, ABRV
	  , LCLAS_CD, IND_CODE, aa.INDUTY_CODE, KOREAN_NM
	  , MANAGE_SN, DTLCLFC_NO, DTLCLFC_NM, TEMA_CODE
	  , INDUTY_GUBUN
	  , INDUTY_GROUP
	  from (
	    select AREA_CODE
	    , UPPER_CODE
	    , code_nm as AREA_NM
	    , ABRV
	    , LCLAS_CD
	    , IND_CODE
	    , INDUTY_CODE 
	    , KOREAN_NM
	    , CASE WHEN SUBSTRING(LCLAS_CD, 1, 1) = 'C' THEN '제조업' 
	           WHEN SUBSTRING(LCLAS_CD, 1, 1) != 'C' THEN '비제조업'
	      END AS INDUTY_GUBUN
	    from (
	      select a.AREA_CODE, UPPER_CODE, AREA_NM, ABRV, LCLAS_CD
	      , IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	IND_CODE
	      , case when b.LCLAS_CD = 'C' then concat(LCLAS_CD,INDUTY_CODE) else LCLAS_CD end as INDUTY_CODE 
	      , KOREAN_NM
	      from TB_AREA_DIV a, TB_IND_CD b
	      where a.`DIV`=2 and b.SE in ( 1, 2 ) 
	    ) ab left outer join tb_cmmncode c
	    on ab.UPPER_CODE = c.CODE
	    and c.code_group_no = 57
	    AND	c.use_at = 'Y'
	  ) aa left outer join (
	    select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
	    from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	    where b.MANAGE_SN = C.MANAGE_SN
	    and b.DTLCLFC_NO = C.DTLCLFC_NO
	    AND b.MANAGE_SN=1
	    GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
	  ) bb
	  <if test="gSelect1 == null and gSelect2 == null ">
	  ON aa.INDUTY_CODE = bb.TEMA_CODE
	  <if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
			<if test="sel_area == 'A'.toString() ">
			  GROUP BY UPPER_CODE
			</if>
			<if test="sel_area == 'C'.toString() ">
			  GROUP BY AREA_CODE
			</if>
		</if>
      GROUP BY INDUTY_GUBUN, UPPER_CODE
	  </if>
		<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
			<if test="induty_select == 'I'.toString() and sel_area == null ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == null ">
			  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == null ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == null and sel_area == 'A'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == null and sel_area == 'C'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
			  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
			  AND aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
			  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
			  on aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
			  on aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			
			<if test="induty_select == 'I'.toString()  ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		AND aa.INDUTY_GUBUN IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		<if test="gSelect1 != 'G'.toString()  ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
				</if>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		<if test="gSelect1 != 'G'.toString()  ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
				</if>
		  	</if>
			
			<if test="induty_select == 'I'.toString() and sel_area == null ">
	  		  GROUP BY INDUTY_GUBUN
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == null ">
			  GROUP BY DTLCLFC_NM
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == null ">
			  GROUP BY INDUTY_CODE
			</if>
			<if test="induty_select == null and sel_area == 'A'.toString() ">
			  GROUP BY UPPER_CODE
			</if>
			<if test="induty_select == null and sel_area == 'C'.toString() ">
			  GROUP BY AREA_CODE
			</if>
			<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
			  GROUP BY INDUTY_GUBUN, UPPER_CODE
			</if>
			<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
			  GROUP BY INDUTY_GUBUN, AREA_CODE
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
			  GROUP BY DTLCLFC_NM, UPPER_CODE
			</if>
			<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
			  GROUP BY DTLCLFC_NM, AREA_CODE
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
			  GROUP BY INDUTY_CODE, UPPER_CODE
			</if>
			<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
			  GROUP BY INDUTY_CODE, AREA_CODE
			</if>
		</if>
		<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
			<if test="induty_select == 'I'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="induty_select == 'T'.toString() ">
			  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
			</if>
			<if test="induty_select == 'D'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
		</if>
		<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
			<if test="sel_area == 'A'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
			<if test="sel_area == 'C'.toString() ">
			  ON aa.INDUTY_CODE = bb.TEMA_CODE
			</if>
		</if>
		
		<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
			<if test="induty_select == 'I'.toString() ">
	  		  GROUP BY INDUTY_GUBUN
			</if>
			<if test="induty_select == 'T'.toString() ">
			  GROUP BY DTLCLFC_NM
			</if>
			<if test="induty_select == 'D'.toString() ">
			  GROUP BY INDUTY_CODE
			</if>
		</if>
		<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
			<if test="sel_area == 'A'.toString() ">
			  GROUP BY UPPER_CODE
			</if>
			<if test="sel_area == 'C'.toString() ">
			  GROUP BY AREA_CODE
			</if>
		</if>
		having 1=1
		<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() ">
			<if test="induty_select == 'I'.toString() and multiSelectGrid1 != null and multiSelectGrid1 != '' ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		AND INDUTY_GUBUN IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		</if>
		<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		  	<if test="sel_area == 'A'.toString() ">
		  		<if test="gSelect1 != 'G'.toString()  ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
				</if>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		<if test="gSelect1 != 'G'.toString()  ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
				</if>
		  	</if>
		</if>
		<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
			<if test="induty_select == 'T'.toString()  ">
			  and bb.TEMA_CODE IS NOT NULL
			</if>
		  	<if test="induty_select == 'I'.toString()  ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		AND aa.INDUTY_GUBUN IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		</if>
	  	AND AREA_CODE NOT IN ('D99')
	) K 
	left outer join 
	(
	  select STDYY_DO
	  , INDUTY_CODE
	  , CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업'
	     WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
	    END AS INDUTY_NM
	  , A.AREA_CODE
	  , B.UPPER_CODE
	  , ENTRPRS_CO
	  , SELNG_AM
	  , BSN_PROFIT
	  , XPORT_AM_WON
	  , ORDTM_LABRR_CO
	  , RSRCH_DEVLOP_CT
	  , THSTRM_NTPF
	  , CORAGE
	  FROM STS_ENTCLS A, TB_AREA_DIV B
	  WHERE A.AREA_CODE = B.AREA_CODE
	  <!-- 검색조건 시작 -->
		<include refid="dynamicWhereSql"/>
		<if test="induty_select == 'I'.toString() ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		and CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
				     WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
				  END IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'A'.toString() ">
	  		and B.UPPER_CODE in 
			<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
	  		and A.AREA_CODE in 
			<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  <!-- 검색조건 끝 -->
	) L
	<if test="gSelect1 == null and gSelect2 == null ">
	ON K.INDUTY_GUBUN = L.INDUTY_NM
    AND K.UPPER_CODE = L.UPPER_CODE
    GROUP BY INDUTY_GUBUN, UPPER_CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY DTLCLFC_NM 
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY INDUTY_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY UPPER_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY INDUTY_GUBUN, UPPER_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY INDUTY_GUBUN, AREA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY DTLCLFC_NM, UPPER_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY DTLCLFC_NM, AREA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY INDUTY_CODE, UPPER_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY INDUTY_CODE, AREA_CODE
		</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString()  ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY DTLCLFC_NM 
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY UPPER_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY AREA_CODE
		</if>
	</if>
	HAVING 1=1
	<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		AND TEMA_CODE IS NOT NULL
	</if>
	<if test="gSelect1 == 'G'.toString() ">
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  and TEMA_CODE IS NOT NULL
		</if>
	  	<if test="induty_select == 'I'.toString() and sel_area == null ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		AND INDUTY_GUBUN IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
  	</if>
  	<if test="gSelect2 == 'G'.toString() ">
	  	<if test="sel_area == 'A'.toString() ">
	  		<if test="gSelect1 != 'G'.toString()  ">
	  		and UPPER_CODE in 
			<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
				#{item}
			</foreach>
			</if>
	  	</if>
	  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
	  		and AREA_CODE in 
			<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
  	</if>
  	<if test="gSelect1 == null and gSelect2 == null ">
		ORDER BY AREA_CODE, INDUTY_GUBUN
	</if>
	</select>
	
	<!-- 주요지표-현황 조건없이 조회 -->
	<select id="idxListAll" resultType="Map">
	SELECT /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.idxListAll */  
	STDYY_DO
	, IFNULL(ROUND(SUM(ENTRPRS_CO),0),0) AS ENTRPRS_CO_SUM
	, IFNULL(ROUND(SUM(SELNG_AM)/ 100000,0),0) AS SELNG_AM_SUM
	, IFNULL(ROUND(SUM(BSN_PROFIT)/ 100000,0),0) AS BSN_PROFIT_SUM
	, IFNULL(ROUND(SUM(XPORT_AM_WON)/ 100000,0),0) AS XPORT_AM_WON_SUM
	, IFNULL(ROUND(SUM(ORDTM_LABRR_CO),0),0) AS ORDTM_LABRR_CO_SUM
	, IFNULL(ROUND(SUM(RSRCH_DEVLOP_CT) / SUM(ENTRPRS_CO)/ 100000,0),0) AS RSRCH_DEVLOP_CT_SUM
	, IFNULL(ROUND(SUM(THSTRM_NTPF)/ 100000,0),0) AS THSTRM_NTPF_SUM
	, IFNULL(ROUND(SUM(SELNG_AM) / SUM(ENTRPRS_CO)/ 100000,0),0) as SELNG_AM
	, IFNULL(ROUND(SUM(BSN_PROFIT) / SUM(ENTRPRS_CO)/ 100000,0),0) as BSN_PROFIT
	, IFNULL(ROUND(SUM(XPORT_AM_WON) / SUM(ENTRPRS_CO)/ 100000,0),0) as XPORT_AM_WON
	, IFNULL(ROUND(SUM(ORDTM_LABRR_CO) / SUM(ENTRPRS_CO),0),0) as ORDTM_LABRR_CO
	, IFNULL(ROUND((SUM(RSRCH_DEVLOP_CT) / SUM(ENTRPRS_CO)/ 100000) / (SUM(SELNG_AM) / SUM(ENTRPRS_CO)/ 100000),2),0) as RSRCH_DEVLOP_CT
	, IFNULL(ROUND(SUM(THSTRM_NTPF) / SUM(ENTRPRS_CO)/ 100000,0),0) as THSTRM_NTPF
	, IFNULL(ROUND(SUM(CORAGE) / SUM(ENTRPRS_CO),0),0) as AVRG_CORAGE
	FROM (
	  select STDYY_DO
	  , INDUTY_CODE
	  , CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업'
	     WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
	    END AS INDUTY_NM
	  , A.AREA_CODE
	  , B.UPPER_CODE
	  , ENTRPRS_CO
	  , SELNG_AM
	  , BSN_PROFIT
	  , XPORT_AM_WON
	  , ORDTM_LABRR_CO
	  , RSRCH_DEVLOP_CT
	  , THSTRM_NTPF
	  , CORAGE
	  FROM STS_ENTCLS A, TB_AREA_DIV B
	  WHERE A.AREA_CODE = B.AREA_CODE
	  <if test="sel_target_year != null and sel_target_year != '' ">
		AND STDYY_DO=#{sel_target_year}
	  </if>
	  <if test="searchCondition != null and searchCondition != '' ">
		AND ENTCLS = #{searchCondition}
	   </if>
	) L
	GROUP BY STDYY_DO
	</select>
	
	<select id="idxMapChart" resultType="Map">
	SELECT /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.idxMapChart */  
	   FN_AREACD2NM(T1.AREA_CODE, 1)
	  ,FN_CD2CDNM(71,T1.GIND)
	  ,ENTRPRS_CO
	  ,SELNG_AM
	  ,XPORT_AM_WON
	  ,RSRCH_DEVLOP_CT
	  ,AVRG_CORAGE
	  ,THSTRM_NTPF
	  ,BSN_PROFIT
	FROM VW_SIDO_CZA T1 left outer join
	  (
	  SELECT 
	    AREA_CODE
	    ,'C' as IND
	    ,SUM(ENTRPRS_CO)  as ENTRPRS_CO    -- 억원
	    ,truncate(SUM(SELNG_AM)/ 100000, 0) as SELNG_AM
	    ,truncate(SUM(XPORT_AM_WON)/ 100000, 0) as XPORT_AM_WON
	    ,truncate(SUM(RSRCH_DEVLOP_CT)/ 100000, 0) as RSRCH_DEVLOP_CT
	    ,truncate(AVG(CORAGE), 0) as AVRG_CORAGE
	    ,truncate(SUM(THSTRM_NTPF)/ 100000, 0) as THSTRM_NTPF
	    ,truncate(SUM(BSN_PROFIT)/ 100000, 0) as BSN_PROFIT
	  FROM STS_ENTCLS 
	  WHERE 1=1
	    <if test="sel_target_year != null and sel_target_year != '' ">
			AND STDYY_DO=#{sel_target_year}
		</if>
	    <if test="searchCondition != null and searchCondition != '' ">
			AND ENTCLS = #{searchCondition}
		</if>
	    AND INDUTY_CODE LIKE 'C%'
	  GROUP BY AREA_CODE
	  UNION ALL
	  SELECT 
	    AREA_CODE
	    ,'Z' as IND
	    ,SUM(ENTRPRS_CO)  as ENTRPRS_CO    -- 억원
	    ,truncate(SUM(SELNG_AM)/ 100000, 0) as SELNG_AM
	    ,truncate(SUM(XPORT_AM_WON)/ 100000, 0) as XPORT_AM_WON
	    ,truncate(SUM(RSRCH_DEVLOP_CT)/ 100000, 0) as RSRCH_DEVLOP_CT
	    ,truncate(AVG(CORAGE), 0) as AVRG_CORAGE
	    ,truncate(SUM(THSTRM_NTPF)/ 100000, 0) as THSTRM_NTPF
	    ,truncate(SUM(BSN_PROFIT)/ 100000, 0) as BSN_PROFIT
	  FROM STS_ENTCLS 
	  WHERE 1=1
	    <if test="sel_target_year != null and sel_target_year != '' ">
			AND STDYY_DO=#{sel_target_year}
		</if>
	    <if test="searchCondition != null and searchCondition != '' ">
			AND ENTCLS = #{searchCondition}
		</if>
	    AND substring(INDUTY_CODE, 1, 1) != 'C'
	  GROUP BY AREA_CODE
	  UNION ALL
	  SELECT 
	    AREA_CODE
	    ,'A' as IND
	    ,SUM(ENTRPRS_CO)  as ENTRPRS_CO    -- 억원
	    ,truncate(SUM(SELNG_AM)/ 100000, 0) as SELNG_AM
	    ,truncate(SUM(XPORT_AM_WON)/ 100000, 0) as XPORT_AM_WON
	    ,truncate(SUM(RSRCH_DEVLOP_CT)/ 100000, 0) as RSRCH_DEVLOP_CT
	    ,truncate(AVG(CORAGE), 0) as AVRG_CORAGE
	    ,truncate(SUM(THSTRM_NTPF)/ 100000, 0) as THSTRM_NTPF
	    ,truncate(SUM(BSN_PROFIT)/ 100000, 0) as BSN_PROFIT
	  FROM STS_ENTCLS 
	  WHERE 1=1
	    <if test="sel_target_year != null and sel_target_year != '' ">
			AND STDYY_DO=#{sel_target_year}
		</if>
	    <if test="searchCondition != null and searchCondition != '' ">
			AND ENTCLS = #{searchCondition}
		</if>
	  GROUP BY AREA_CODE
	  ) T2
	ON T1.AREA_CODE = T2.AREA_CODE AND T1.GIND = T2.IND
	WHERE 
	  T1.GIND IN ( 'C', 'Z' )
	</select>
	
	
	<!-- 주요지표-구간별현황 조회 -->
	<select id="sectionIdxList" resultType="Map">
	<if test="sel_area != null and gSelect1 != 'G'.toString()  ">
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.sectionIdxList */
	L.STDYY_DO
	, L.ENTCLS
	, K.UPPER_CODE
	, L.UPPER_CODE AS UPPER_CODE2
	, K.AREA_NM
	, K.AREA_CODE
	, L.AREA_CODE AS AREA_CODE2
	, '전체' AS AREA1
	, K.LCLAS_CD
	, K.INDUTY_CODE
	, K.KOREAN_NM
	, K.MANAGE_SN
	, K.DTLCLFC_NO
	, K.DTLCLFC_NM
	, K.TEMA_CODE
	, K.INDUTY_GUBUN
	, K.INDUTY_GROUP
	, L.INDUTY_CODE,
	<if test="induty_select == 'I'.toString() ">
	 K.INDUTY_GUBUN as COL1, 
	</if>
	<if test="induty_select == 'T'.toString() ">
	 K.DTLCLFC_NM as COL1, 
	</if>
	<if test="induty_select == 'D'.toString() ">
	 K.KOREAN_NM as COL1, 
	</if>
	<!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxOutTB"/>
	FROM (
	select 
	AREA_CODE, UPPER_CODE, AREA_NM, ABRV
	, LCLAS_CD, IND_CODE, aa.INDUTY_CODE, KOREAN_NM
	, MANAGE_SN, DTLCLFC_NO, DTLCLFC_NM, TEMA_CODE
	, INDUTY_GUBUN
	, INDUTY_GROUP
	from (
	  select AREA_CODE
	  , UPPER_CODE
	  , code_nm as AREA_NM
	  , ABRV
	  , LCLAS_CD
	  , IND_CODE
	  , INDUTY_CODE 
	  , KOREAN_NM
	  , CASE WHEN SUBSTRING(LCLAS_CD, 1, 1) = 'C' THEN '제조업' 
	           WHEN SUBSTRING(LCLAS_CD, 1, 1) != 'C' THEN '비제조업'
	      END AS INDUTY_GUBUN
	  from (
	    select a.AREA_CODE, UPPER_CODE, AREA_NM, ABRV, LCLAS_CD
	    , IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	IND_CODE
	    , case when b.LCLAS_CD = 'C' then concat(LCLAS_CD,INDUTY_CODE) else LCLAS_CD end as INDUTY_CODE 
	    , KOREAN_NM
	    from TB_AREA_DIV a, TB_IND_CD b
	    where a.`DIV`=2 and b.SE in ( 1, 2 ) 
	  ) ab left outer join tb_cmmncode c
	  on ab.UPPER_CODE = c.CODE
	  and c.code_group_no = 57
	  AND	c.use_at = 'Y'
	) aa left outer join (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	  AND b.MANAGE_SN=1
	  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
	) bb
	<if test="gSelect1 == null and gSelect2 == null ">
	  ON aa.INDUTY_CODE = bb.TEMA_CODE
      GROUP BY INDUTY_GUBUN, UPPER_CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		  AND aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	
	<if test="induty_select == 'T'.toString()  ">
	  and bb.TEMA_CODE IS NOT NULL
	</if>
  	<if test="induty_select == 'I'.toString()  ">
  		<if test="all_induty != 'Y'.toString() ">
	  		AND aa.INDUTY_GUBUN IN 
			<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</if>
	<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
  		and INDUTY_CODE IN 
		<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
			#{item}
		</foreach>
  	</if>
  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
  		and INDUTY_CODE IN 
		<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
			#{item}
		</foreach>
  	</if>
  	<if test="sel_area == 'A'.toString() ">
  		<if test="gSelect1 != 'G'.toString()  ">
  		and UPPER_CODE in ( 'WC01' , 'WC02' , 'WC03' , 'WC04' , 'WC05' , 'WC06' , 'WC07' , 'WC08' ) 
		</if>
  	</if>
  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
  		and AREA_CODE in ( 'D01' , 'D02' , 'D03' , 'D04' , 'D05' , 'D06' , 'D07' , 'D08' , 'D09' , 'D10' , 'D11' , 'D12' , 'D13', 'D14' , 'D15' , 'D16' , 'D17' )
  	</if>
	
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
  		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  GROUP BY DTLCLFC_NM
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  GROUP BY INDUTY_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  GROUP BY UPPER_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  GROUP BY AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY INDUTY_GUBUN, UPPER_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY INDUTY_GUBUN, AREA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY DTLCLFC_NM, UPPER_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY DTLCLFC_NM, AREA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY INDUTY_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
  		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() ">
		  GROUP BY DTLCLFC_NM
		</if>
		<if test="induty_select == 'D'.toString() ">
		  GROUP BY INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  GROUP BY UPPER_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  GROUP BY AREA_CODE
		</if>
	</if>
	
	) K
	LEFT OUTER JOIN 
	(
	SELECT SCTN.STDYY_DO,
     SCTN.ENTCLS,
     SCTN.INDUTY_CODE,
     CASE WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) = 'C' THEN '제조업'
          WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
     END AS INDUTY_NM,
     B.UPPER_CODE,
     SCTN.AREA_CODE,
     <!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxInTB"/>	
	, TB_AREA_DIV B
	WHERE SCTN.AREA_CODE = B.AREA_CODE
	<!-- 검색조건 시작 -->
		<include refid="dynamicWhereSql"/>
		<if test="induty_select == 'I'.toString() and sel_area == null ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		and CASE WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
				     WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
				  END IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	) L
	<if test="gSelect1 == null and gSelect2 == null ">
	ON K.INDUTY_GUBUN = L.INDUTY_NM
    AND K.UPPER_CODE = L.UPPER_CODE
    GROUP BY K.INDUTY_GUBUN
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY K.INDUTY_GUBUN
		  HAVING INDUTY_GUBUN IS NOT NULL
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY K.DTLCLFC_NM 
		  HAVING DTLCLFC_NM IS NOT NULL
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY K.INDUTY_CODE
		  HAVING L.INDUTY_CODE IS NOT NULL
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_GUBUN
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.DTLCLFC_NM
		  HAVING UPPER_CODE2 IS NOT NULL
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.DTLCLFC_NM
		  HAVING AREA_CODE2 IS NOT NULL
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_CODE
		  HAVING UPPER_CODE2 IS NOT NULL
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY L.INDUTY_CODE
		  HAVING AREA_CODE2 IS NOT NULL
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		</if>
	</if>
	UNION
	</if>
	select /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.sectionIdxList */
	L.STDYY_DO
	, L.ENTCLS
	, K.UPPER_CODE
	, L.UPPER_CODE AS UPPER_CODE2
	, K.AREA_NM
	, K.AREA_CODE
	, L.AREA_CODE AS AREA_CODE2
	<if test="sel_area == 'A'.toString() ">
	, K.AREA_NM AS AREA1
	</if>
	<if test="sel_area == 'C'.toString() ">
	, K.ABRV AS AREA1
	</if>
	, K.LCLAS_CD
	, K.INDUTY_CODE
	, K.KOREAN_NM
	, K.MANAGE_SN
	, K.DTLCLFC_NO
	, K.DTLCLFC_NM
	, K.TEMA_CODE
	, K.INDUTY_GUBUN
	, K.INDUTY_GROUP
	, L.INDUTY_CODE,
	<if test="induty_select == 'I'.toString() ">
	 K.INDUTY_GUBUN as COL1,
	</if>
	<if test="induty_select == 'T'.toString() ">
	 K.DTLCLFC_NM as COL1,
	</if>
	<if test="induty_select == 'D'.toString() ">
	 K.KOREAN_NM as COL1,
	</if>
	<!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxOutTB"/>
	FROM (
	select 
	AREA_CODE, UPPER_CODE, AREA_NM, ABRV
	, LCLAS_CD, IND_CODE, aa.INDUTY_CODE, KOREAN_NM
	, MANAGE_SN, DTLCLFC_NO, DTLCLFC_NM, TEMA_CODE
	, INDUTY_GUBUN
	, INDUTY_GROUP
	from (
	  select AREA_CODE
	  , UPPER_CODE
	  , code_nm as AREA_NM
	  , ABRV
	  , LCLAS_CD
	  , IND_CODE
	  , INDUTY_CODE 
	  , KOREAN_NM
	  , CASE WHEN SUBSTRING(LCLAS_CD, 1, 1) = 'C' THEN '제조업' 
	           WHEN SUBSTRING(LCLAS_CD, 1, 1) != 'C' THEN '비제조업'
	      END AS INDUTY_GUBUN
	  from (
	    select a.AREA_CODE, UPPER_CODE, AREA_NM, ABRV, LCLAS_CD
	    , IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	IND_CODE
	    , case when b.LCLAS_CD = 'C' then concat(LCLAS_CD,INDUTY_CODE) else LCLAS_CD end as INDUTY_CODE 
	    , KOREAN_NM
	    from TB_AREA_DIV a, TB_IND_CD b
	    where a.`DIV`=2 and b.SE in ( 1, 2 ) 
	  ) ab left outer join tb_cmmncode c
	  on ab.UPPER_CODE = c.CODE
	  and c.code_group_no = 57
	  AND	c.use_at = 'Y'
	) aa left outer join (
	  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
	  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	  where b.MANAGE_SN = C.MANAGE_SN
	  and b.DTLCLFC_NO = C.DTLCLFC_NO
	  AND b.MANAGE_SN=1
	  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
	) bb
	<if test="gSelect1 == null and gSelect2 == null ">
	  ON aa.INDUTY_CODE = bb.TEMA_CODE
      GROUP BY INDUTY_GUBUN, UPPER_CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		  AND aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	
	<if test="induty_select == 'T'.toString()  ">
	  and bb.TEMA_CODE IS NOT NULL
	</if>
  	<if test="induty_select == 'I'.toString()  ">
  		<if test="all_induty != 'Y'.toString() ">
	  		AND aa.INDUTY_GUBUN IN 
			<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
	</if>
	<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
  		and INDUTY_CODE IN 
		<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
			#{item}
		</foreach>
  	</if>
  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
  		and INDUTY_CODE IN 
		<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
			#{item}
		</foreach>
  	</if>
  	<if test="sel_area == 'A'.toString() ">
  		<if test="gSelect1 != 'G'.toString()  ">
  		and UPPER_CODE in 
		<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
			#{item}
		</foreach>
		</if>
  	</if>
  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
  		and AREA_CODE in 
		<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
			#{item}
		</foreach>
  	</if>
	
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
  		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  GROUP BY DTLCLFC_NM
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  GROUP BY INDUTY_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  GROUP BY UPPER_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  GROUP BY AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY INDUTY_GUBUN, UPPER_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY INDUTY_GUBUN, AREA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY DTLCLFC_NM, UPPER_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY DTLCLFC_NM, AREA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  GROUP BY INDUTY_CODE, UPPER_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  GROUP BY INDUTY_CODE, AREA_CODE
		</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
  		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() ">
		  GROUP BY DTLCLFC_NM
		</if>
		<if test="induty_select == 'D'.toString() ">
		  GROUP BY INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  GROUP BY UPPER_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  GROUP BY AREA_CODE
		</if>
	</if>
	
	having 1=1
	AND AREA_CODE NOT IN ('D99')
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
				     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
				  END IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'A'.toString() ">
	  		<if test="gSelect1 != 'G'.toString()  ">
	  		and UPPER_CODE in 
			<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
				#{item}
			</foreach>
			</if>
	  	</if>
	  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
	  		and AREA_CODE in 
			<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
				     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
				  END IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
  	</if>
  	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
	  	and AREA_CODE NOT IN ('D99')
  	</if>
	) K
	LEFT OUTER JOIN 
	(
	SELECT SCTN.STDYY_DO,
     SCTN.ENTCLS,
     SCTN.INDUTY_CODE,
     CASE WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) = 'C' THEN '제조업'
          WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
     END AS INDUTY_NM,
     B.UPPER_CODE,
     SCTN.AREA_CODE,
     <!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxInTB"/>	
	, TB_AREA_DIV B
	WHERE SCTN.AREA_CODE = B.AREA_CODE
	<!-- 검색조건 시작 -->
		<include refid="dynamicWhereSql"/>
		<if test="induty_select == 'I'.toString()  ">
	  		<if test="all_induty != 'Y'.toString() ">
		  		and CASE WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
				     WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
				  END IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
		<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'A'.toString() ">
	  		and B.UPPER_CODE in 
			<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
	  		and SCTN.AREA_CODE in 
			<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	) L
	<if test="gSelect1 == null and gSelect2 == null ">
	ON K.INDUTY_GUBUN = L.INDUTY_NM
    AND K.UPPER_CODE = L.UPPER_CODE
    GROUP BY K.INDUTY_GUBUN, K.UPPER_CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY K.INDUTY_GUBUN
		  -- HAVING INDUTY_GUBUN IS NOT NULL
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY K.DTLCLFC_NM 
		  -- HAVING DTLCLFC_NM IS NOT NULL
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY K.INDUTY_CODE
		  -- HAVING L.INDUTY_CODE IS NOT NULL
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.UPPER_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_GUBUN, K.UPPER_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.INDUTY_GUBUN, K.AREA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.DTLCLFC_NM, K.UPPER_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.DTLCLFC_NM, K.AREA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_CODE, K.UPPER_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY L.INDUTY_CODE, L.AREA_CODE
		</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString()  ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY K.INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY K.DTLCLFC_NM 
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY K.INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.UPPER_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.AREA_CODE
		</if>
	</if>
	HAVING 1=1
	AND STDYY_DO IS NOT NULL
	<if test="gSelect1 == null and gSelect2 == null ">
	AND UPPER_CODE IS NOT NULL
	</if>
  	ORDER BY UPPER_CODE, AREA_CODE
	</select>
	
	
	
	<!-- 주요지표-구간별현황 조건없이 조회 -->
	<select id="sectionIdxListAll" resultType="Map">
	SELECT /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.sectionIdxListAll */  
	<!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxOutTB"/>
	FROM (
	 SELECT SCTN.STDYY_DO,
     SCTN.ENTCLS,
     SCTN.INDUTY_CODE,
     CASE WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) = 'C' THEN '제조업'
          WHEN SUBSTRING(SCTN.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
     END AS INDUTY_NM,
     B.UPPER_CODE,
     SCTN.AREA_CODE,
     <!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionIdxInTB"/>	
	, TB_AREA_DIV B
	WHERE SCTN.AREA_CODE = B.AREA_CODE
	  <if test="sel_target_year != null and sel_target_year != '' ">
		AND STDYY_DO=#{sel_target_year}
	  </if>
	  <if test="searchCondition != null and searchCondition != '' ">
		AND ENTCLS = #{searchCondition}
	  </if>
	) L
	GROUP BY STDYY_DO
	</select>
	
	
	
	<!-- 주요지표-현황 추이 목록 조회 -->
	<select id="trnsitnList" resultType="Map">
		<foreach item="item" index="index" collection="array_index_kind" open="" separator="" close="">
		<if test="item == 'JP01' ">
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end), 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G01' AS JIPYO
			, '기업수' AS JIPYO_NM
			, ifnull(ENTRPRS_CO,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN 
			(
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		<if test="item == 'JP02' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, ROUND(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / 1000000000, 1) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G02' AS JIPYO
			, '매출액' AS JIPYO_NM
			, ifnull(SELNG_AM,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'JP03' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) /100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G03' AS JIPYO
			, '영업이익' AS JIPYO_NM
			, ifnull(BSN_PROFIT,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'JP04' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) /100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G04' AS JIPYO
			, '수출액' AS JIPYO_NM
			, ifnull(XPORT_AM_WON,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'JP05' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end), 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G05' AS JIPYO
			, '근로자수' AS JIPYO_NM
			, ifnull(ORDTM_LABRR_CO,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'JP06' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(MAX(case when STDYY_DO=replace(#{item}, 'data', '') then VAL / VAL2 else 0 end), 2) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G06' AS JIPYO
			, 'RnD집약도' AS JIPYO_NM
			, ifnull(RSRCH_DEVLOP_CT, 0) AS VAL
			, ifnull(SELNG_AM, 0) AS VAL2 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'JP07' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / 100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'G07' AS JIPYO
			, '당기순이익' AS JIPYO_NM
			, ifnull(THSTRM_NTPF,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		</foreach>
		order by AREA_CODE
	</select>
	
	<select id="trnsitnListAvg" resultType="Map">
		<foreach item="item" index="index" collection="array_index_kind" open="" separator="" close="">
		<if test="item == 'AJP01' ">
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnListAvg */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end), 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG01' AS JIPYO
			, '기업수' AS JIPYO_NM
			, ifnull(ENTRPRS_CO,0) AS VAL 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		<if test="item == 'AJP02' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end) / 100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG02' AS JIPYO
			, '평균매출액' AS JIPYO_NM
			, ifnull(SELNG_AM,0) AS VAL 
			, ifnull(ENTRPRS_CO,0) AS VAL2
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP03' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end)/SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end) /100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG03' AS JIPYO
			, '평균영업이익' AS JIPYO_NM
			, ifnull(BSN_PROFIT,0) AS VAL 
			, ifnull(ENTRPRS_CO,0) AS VAL2
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP04' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end)/SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end) /100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG04' AS JIPYO
			, '평균수출액' AS JIPYO_NM
			, ifnull(XPORT_AM_WON,0) AS VAL 
			, ifnull(ENTRPRS_CO,0) AS VAL2
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP05' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end), 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG05' AS JIPYO
			, '평균근로자수' AS JIPYO_NM
			, ifnull(ORDTM_LABRR_CO,0) AS VAL
			, ifnull(ENTRPRS_CO,0) AS VAL2 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP06' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(MAX(case when STDYY_DO=replace(#{item}, 'data', '') then VAL / VAL2 else 0 end), 2) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG06' AS JIPYO
			, '평균RnD집약도' AS JIPYO_NM
			, ifnull(RSRCH_DEVLOP_CT, 0) AS VAL
			, ifnull(SELNG_AM, 0) AS VAL2 
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP07' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end) / 100000, 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG07' AS JIPYO
			, '평균당기순이익' AS JIPYO_NM
			, ifnull(THSTRM_NTPF,0) AS VAL 
			, ifnull(ENTRPRS_CO,0) AS VAL2
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		
		<if test="item == 'AJP08' ">
			<if test="index != 0 ">
			UNION
			</if>
			select  /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.trnsitnList2 */
			K.STDYY_DO
			, K.ENTCLS
			, K.INDUTY_CODE
			, K.AREA_CODE
			, K.JIPYO
			, K.JIPYO_NM AS GUBUN1
			, K.UPPER_CODE
			<if test="sel_area == 'A'.toString() ">
			, K.CODE_NM AS AREA1
			</if>
			<if test="sel_area == 'C'.toString() ">
			, K.ABRV AS AREA1
			</if>
			, K.DTLCLFC_NO
			<if test="induty_select == 'T'.toString() ">
			, K.DTLCLFC_NM AS COL1
			</if>
			, K.TEMA_CODE
			<if test="induty_select == 'I'.toString() ">
			, INDUTY_GUBUN as COL1
			</if>
			<if test="induty_select == 'D'.toString() ">
			, K.KOREAN_NM as COL1
			</if>
			, K.INDUTY_GROUP
			<foreach item="item" collection="selectYear" open="" separator="" close="">
				, round(SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL else 0 end) / SUM(case when STDYY_DO=replace(#{item}, 'data', '') then VAL2 else 0 end), 0) as #{item}
			</foreach>
			FROM (
			select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE
			, 'AG08' AS JIPYO
			, '평균업력' AS JIPYO_NM
			, ifnull(CORAGE,0) AS VAL 
			, ifnull(ENTRPRS_CO,0) AS VAL2
			, B.UPPER_CODE, B.AREA_NM, B.ABRV, C.MANAGE_SN, C.DTLCLFC_NO, C.DTLCLFC_NM, C.TEMA_CODE, C.INDUTY_GROUP, TC.CODE_NM
			, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
			         WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
			    END AS INDUTY_GUBUN
			, IND.KOREAN_NM
			FROM STS_ENTCLS A LEFT OUTER JOIN TB_AREA_DIV B
			ON A.AREA_CODE = B.AREA_CODE
			LEFT OUTER JOIN tb_cmmncode TC
			ON B.UPPER_CODE = TC.CODE
			AND TC.CODE_GROUP_NO=57
			LEFT OUTER JOIN (
               SELECT IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	INDUTY_CODE, KOREAN_NM, LCLAS_CD
               FROM		TB_IND_CD
               WHERE	LCLAS_CD = 'C' AND SE = '2'
             ) IND
			ON A.INDUTY_CODE = IND.INDUTY_CODE
			LEFT OUTER JOIN
			(
			  select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
			  from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
			  where b.MANAGE_SN = C.MANAGE_SN
			  and b.DTLCLFC_NO = C.DTLCLFC_NO
			  AND b.MANAGE_SN=1
			  GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
			) C
			ON C.INDUTY_GROUP LIKE CONCAT('%',A.INDUTY_CODE, '%')
			) K
			WHERE 1=1
			<if test="searchCondition != null and searchCondition != '' ">
				AND ENTCLS = #{searchCondition}
			</if>
			<if test="induty_select == 'I'.toString() ">
		  		<if test="all_induty != 'Y'.toString() ">
			  		and CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' 
					     WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업'
					  END IN 
					<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
						#{item}
					</foreach>
				</if>
			</if>
			<if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
		  		and INDUTY_CODE IN 
				<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'A'.toString() ">
		  		and UPPER_CODE in 
				<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
		  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
		  		and AREA_CODE in 
				<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
					#{item}
				</foreach>
		  	</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
				<if test="induty_select == 'I'.toString() and sel_area == null ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == null ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == null ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == null and sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="induty_select == null and sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_GUBUN, UPPER_CODE
				</if>
				<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_GUBUN, AREA_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY DTLCLFC_NM, UPPER_CODE
				</if>
				<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY DTLCLFC_NM, AREA_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
				<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
				<if test="induty_select == 'I'.toString() ">
		  		  GROUP BY INDUTY_GUBUN
				</if>
				<if test="induty_select == 'T'.toString() ">
				  GROUP BY DTLCLFC_NM
				</if>
				<if test="induty_select == 'D'.toString() ">
				  GROUP BY INDUTY_CODE
				</if>
			</if>
			<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
				<if test="sel_area == 'A'.toString() ">
				  GROUP BY UPPER_CODE
				</if>
				<if test="sel_area == 'C'.toString() ">
				  GROUP BY AREA_CODE
				</if>
			</if>
		</if>
		</foreach>
		order by AREA_CODE
	</select>
	
	
	
	<!-- 주요지표-구간별추이 목록 조회 -->
	<select id="sectionTrnsitnList" resultType="Map">
	SELECT   /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.sectionTrnsitnList */
	L.STDYY_DO
	, K.AREA_CODE
	, K.UPPER_CODE
	<if test="gSelect1 == null and gSelect2 == null ">
	, K.AREA_NM AS AREA1
	</if>
	<if test="sel_area == 'A'.toString() ">
	, K.AREA_NM AS AREA1
	</if>
	<if test="sel_area == 'C'.toString() ">
	, K.ABRV AS AREA1
	</if>
	, K.LCLAS_CD
	, K.IND_CODE
	, K.INDUTY_CODE
	, K.KOREAN_NM
	, K.MANAGE_SN
	, K.DTLCLFC_NO
	, K.DTLCLFC_NM
	, K.TEMA_CODE
	<if test="gSelect1 == null and gSelect2 == null ">
	, K.INDUTY_GUBUN as COL1
	</if>
	<if test="induty_select == 'I'.toString() ">
	, K.INDUTY_GUBUN as COL1
	</if>
	<if test="induty_select == 'T'.toString() ">
	, K.DTLCLFC_NM as COL1
	</if>
	<if test="induty_select == 'D'.toString() ">
	, K.KOREAN_NM as COL1
	</if>
	, K.INDUTY_GROUP
	, L.ENTCLS
	, L.INDUTY_CODE AS INDUTY_CODE2
	, L.AREA_CODE AS AREA_CODE2
	, L.UPPER_CODE AS UPPER_CODE2
	, L.CODE
	, L.CODE_NM AS GUBUN1
	<foreach item="item" collection="selectYear" open="" separator="" close="">
		<if test="sel_index_type != 'F'.toString() ">
		, ifnull(sum(case when STDYY_DO=#{item} then SCTN1 else 0 end),0) as #{item}
		</if>
		<if test="sel_index_type == 'F'.toString() ">
		, ifnull(ROUND(sum(case when STDYY_DO=#{item} then SCTN1_1 else 0 end) / sum(case when STDYY_DO=#{item} then SCTN1 else 0 end),2),0) as #{item}
		</if>
	</foreach>
	 FROM (
	  select 
	  AREA_CODE, UPPER_CODE, AREA_NM, ABRV
	  , LCLAS_CD, IND_CODE, aa.INDUTY_CODE, KOREAN_NM
	  , MANAGE_SN, DTLCLFC_NO, DTLCLFC_NM, TEMA_CODE
	  , INDUTY_GUBUN
	  , INDUTY_GROUP
	  from (
	    select AREA_CODE
	    , UPPER_CODE
	    , code_nm as AREA_NM
	    , ABRV
	    , LCLAS_CD
	    , IND_CODE
	    , INDUTY_CODE 
	    , KOREAN_NM
	    , CASE WHEN SUBSTRING(LCLAS_CD, 1, 1) = 'C' THEN '제조업' 
	           WHEN SUBSTRING(LCLAS_CD, 1, 1) != 'C' THEN '비제조업'
	      END AS INDUTY_GUBUN
	    from (
	      select a.AREA_CODE, UPPER_CODE, AREA_NM, ABRV, LCLAS_CD
	      , IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	IND_CODE
	      , case when b.LCLAS_CD = 'C' then concat(LCLAS_CD,INDUTY_CODE) else LCLAS_CD end as INDUTY_CODE 
	      , KOREAN_NM
	      from TB_AREA_DIV a, TB_IND_CD b
	      where a.`DIV`=2 and b.SE in ( 1, 2 ) 
	    ) ab left outer join tb_cmmncode c
	    on ab.UPPER_CODE = c.CODE
	    and c.code_group_no = 57
	    AND	c.use_at = 'Y'
	  ) aa left outer join (
	    select b.MANAGE_SN, b.DTLCLFC_NO, b.DTLCLFC_NM, C.INDUTY_CODE as TEMA_CODE, GROUP_CONCAT(INDUTY_CODE) AS INDUTY_GROUP
	    from TB_THEMA_DTLS b, TB_THEMA_INDUTY C
	    where b.MANAGE_SN = C.MANAGE_SN
	    and b.DTLCLFC_NO = C.DTLCLFC_NO
	    AND b.MANAGE_SN=1
	    GROUP BY b.MANAGE_SN, b.DTLCLFC_NO
	  ) bb
	  <if test="gSelect1 == null and gSelect2 == null ">
	  ON aa.INDUTY_CODE = bb.TEMA_CODE
      GROUP BY INDUTY_GUBUN, UPPER_CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		  GROUP BY TEMA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_CODE
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY UPPER_CODE
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY AREA_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_GUBUN, UPPER_CODE
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_GUBUN, AREA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		  AND aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  on aa.INDUTY_CODE = bb.TEMA_CODE
		</if>
	</if>
	
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_GUBUN
		</if>
		<if test="induty_select == 'T'.toString() ">
		  on bb.INDUTY_GROUP LIKE CONCAT('%',aa.INDUTY_CODE,'%')
		  GROUP BY TEMA_CODE
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY INDUTY_CODE
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY UPPER_CODE
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON aa.INDUTY_CODE = bb.TEMA_CODE
		  GROUP BY TEMA_CODE
		</if>
	</if>
	  HAVING 1=1
	  
	) K 
	right outer join 
	(
	  <!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionTrnsitnListTB"/>
	     AND STDYY_DO BETWEEN #{from_sel_target_year} AND #{to_sel_target_year}
	     <include refid="dynamicWhereSql"/>
	     <if test="induty_select == 'I'.toString() and sel_area == null ">
			<if test="all_induty != 'Y'.toString() ">
		  		and INDUTY_NM IN 
				<foreach item="item" collection="multiSelectGrid1" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		 </if>
		 <if test="induty_select == 'T'.toString() and multiSelectGrid2 != null and multiSelectGrid2 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="induty_select == 'D'.toString() and multiSelectGrid3 != null and multiSelectGrid3 != '' ">
	  		and INDUTY_CODE IN 
			<foreach item="item" collection="multiSelectGrid3" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'A'.toString() ">
	  		and B.UPPER_CODE in 
			<foreach item="item" collection="cmpn_area_depth1" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  	<if test="sel_area == 'C'.toString() and cmpn_area_depth2 != null and cmpn_area_depth2 != '' ">
	  		and SCTN.AREA_CODE in 
			<foreach item="item" collection="cmpn_area_depth2" open="(" separator="," close=")">
				#{item}
			</foreach>
	  	</if>
	  ) Y
	  ON X.CODE = Y.CODE
	) L
	<if test="gSelect1 == null and gSelect2 == null ">
	ON K.INDUTY_GUBUN = L.INDUTY_NM
    AND K.UPPER_CODE = L.UPPER_CODE
    GROUP BY K.INDUTY_GUBUN, K.UPPER_CODE, L.CODE
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'W'.toString() or gSelect1 == 'G'.toString() and gSelect2 == 'G'.toString() ">
		<if test="induty_select == 'I'.toString() and sel_area == null ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY K.INDUTY_GUBUN, L.CODE_NM
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == null ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY K.DTLCLFC_NM, L.CODE_NM
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == null ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY K.INDUTY_CODE, L.CODE_NM
		</if>
		<if test="induty_select == null and sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.UPPER_CODE, L.CODE_NM
		</if>
		<if test="induty_select == null and sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.AREA_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_GUBUN, K.UPPER_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'I'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.INDUTY_GUBUN, K.AREA_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.DTLCLFC_NM, K.UPPER_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'T'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.DTLCLFC_NM, K.AREA_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'A'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.UPPER_CODE = L.UPPER_CODE
		  GROUP BY K.INDUTY_CODE, K.UPPER_CODE, L.CODE_NM
		</if>
		<if test="induty_select == 'D'.toString() and sel_area == 'C'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  AND K.AREA_CODE = L.AREA_CODE
		  GROUP BY L.INDUTY_CODE, L.AREA_CODE, L.CODE_NM
		</if>
	</if>
	<if test="gSelect1 == 'G'.toString() and gSelect2 == 'W'.toString() ">
		<if test="induty_select == 'I'.toString()  ">
		  ON K.INDUTY_GUBUN = L.INDUTY_NM
		  GROUP BY K.INDUTY_GUBUN, L.CODE_NM
		</if>
		<if test="induty_select == 'T'.toString() ">
		  ON K.INDUTY_GROUP LIKE CONCAT('%',L.INDUTY_CODE,'%')
		  GROUP BY K.DTLCLFC_NM , L.CODE_NM
		</if>
		<if test="induty_select == 'D'.toString() ">
		  ON K.INDUTY_CODE = L.INDUTY_CODE
		  GROUP BY K.INDUTY_CODE, L.CODE_NM
		</if>
	</if>
	<if test="gSelect1 == 'W'.toString() and gSelect2 == 'G'.toString() ">
		<if test="sel_area == 'A'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.UPPER_CODE, L.CODE_NM
		</if>
		<if test="sel_area == 'C'.toString() ">
		  ON K.AREA_CODE = L.AREA_CODE
		  GROUP BY K.AREA_CODE, L.CODE_NM
		</if>
	</if>
	HAVING 1=1
	<if test="gSelect1 == null and gSelect2 == null ">
     AND UPPER_CODE != 'D99'
	</if>
	<if test="sel_area == 'A'.toString() ">
	  AND K.UPPER_CODE IS NOT NULL
	</if>
	order by UPPER_CODE, INDUTY_CODE, TEMA_CODE, OUTPT_ORDR
	</select>
	
	<!-- 주요지표-구간별추이 목록 조건없이 조회 -->
	<select id="sectionTrnsitnListAll" resultType="Map">
	SELECT   /* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.sectionTrnsitnListAll */
	OUTPT_ORDR
	, CODE_NM as GUBUN1
	<foreach item="item" collection="selectYear" open="" separator="" close="">
		<if test="sel_index_type != 'F'.toString() ">
		, sum(case when STDYY_DO=#{item} then SCTN1 else 0 end) as #{item}
		</if>
		<if test="sel_index_type == 'F'.toString() ">
		, ROUND(sum(case when STDYY_DO=#{item} then SCTN1_1 else 0 end) / sum(case when STDYY_DO=#{item} then SCTN1 else 0 end),0) as #{item}
		</if>
	</foreach>
	FROM (
	 <!-- 지표 선택시 마다 변경될 테이블 -->
     <include refid="sectionTrnsitnListTB"/>
	    AND STDYY_DO BETWEEN #{from_sel_target_year} AND #{to_sel_target_year}
		<if test="searchCondition != null and searchCondition != '' ">
		  		and ENTCLS = #{searchCondition}
		</if>
	  ) Y
	  ON X.CODE = Y.CODE
	  ) K
	  GROUP BY OUTPT_ORDR
	</select>
	

	<!-- 구간별현황 지표선택 시 변경될 테이블 목록 -->
     <sql id="sectionTrnsitnListTB">
     <trim>
        <if test="sel_index_type == null or sel_index_type == 'A'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=67
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS01' AS CODE, A.SCTN1
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS02' AS CODE, A.SCTN2
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS03' AS CODE, A.SCTN3
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS04' AS CODE, A.SCTN4
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS05' AS CODE, A.SCTN5
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS06' AS CODE, A.SCTN6
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'RS07' AS CODE, A.SCTN7
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_RND_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE 
		</if>
		<if test="sel_index_type == 'B'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=61
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS01' AS CODE, A.SCTN1
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS02' AS CODE, A.SCTN2
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS03' AS CODE, A.SCTN3
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS04' AS CODE, A.SCTN4
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS05' AS CODE, A.SCTN5
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS06' AS CODE, A.SCTN6
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS07' AS CODE, A.SCTN7
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_INDUTY_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE 
		</if>
		<if test="sel_index_type == 'C'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=66
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS01' AS CODE, A.SCTN1
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS02' AS CODE, A.SCTN2
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS03' AS CODE, A.SCTN3
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS04' AS CODE, A.SCTN4
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS05' AS CODE, A.SCTN5
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS06' AS CODE, A.SCTN6
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'XS07' AS CODE, A.SCTN7
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_XPORT_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE 
		</if>
		<if test="sel_index_type == 'D'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=68
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS01' AS CODE, A.SCTN1
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS02' AS CODE, A.SCTN2
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS03' AS CODE, A.SCTN3
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS04' AS CODE, A.SCTN4
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS05' AS CODE, A.SCTN5
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			    UNION
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'LS06' AS CODE, A.SCTN6
			      , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_LABRR_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE 
		</if>
		<if test="sel_index_type == 'E'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=60
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC01' AS CODE, A.SCTN1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC02' AS CODE, A.SCTN2
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC03' AS CODE, A.SCTN3
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC04' AS CODE, A.SCTN4
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC05' AS CODE, A.SCTN5
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'AC06' AS CODE, A.SCTN6
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_CORAGE_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE 
		</if>
		<if test="sel_index_type == 'F'.toString() ">
			SELECT Y.STDYY_DO, Y.ENTCLS, Y.INDUTY_CODE, Y.AREA_CODE, Y.CODE, X.CODE_NM, Y.SCTN1, Y.SCTN1_1, Y.INDUTY_NM, Y.UPPER_CODE, Y.AREA_NM, Y.ABRV, X.OUTPT_ORDR
			FROM (
			  SELECT CODE, CODE_NM, OUTPT_ORDR FROM tb_cmmncode
			  WHERE CODE_GROUP_NO=61
			) X LEFT OUTER JOIN (
			  SELECT SCTN.STDYY_DO, SCTN.ENTCLS, SCTN.INDUTY_CODE, SCTN.AREA_CODE, SCTN.CODE, SCTN.SCTN1, SCTN.SCTN1_1, SCTN.INDUTY_NM
			    , B.UPPER_CODE, B.AREA_NM, B.ABRV
			  FROM (
			    SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS01' AS CODE, A.SCTN1, A.SCTN1_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS02' AS CODE, A.SCTN2, A.SCTN2_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS03' AS CODE, A.SCTN3, A.SCTN3_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS04' AS CODE, A.SCTN4, A.SCTN4_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS05' AS CODE, A.SCTN5, A.SCTN5_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			      UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS06' AS CODE, A.SCTN6, A.SCTN6_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
            	  UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS07' AS CODE, A.SCTN7, A.SCTN7_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
            	  UNION
			      SELECT A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'SS08' AS CODE, A.SCTN8, A.SCTN8_1
			        , CASE WHEN SUBSTRING(INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end AS INDUTY_NM FROM STS_SELNG_RND_SCTN A
			  ) SCTN, TB_AREA_DIV B
			  WHERE SCTN.AREA_CODE = B.AREA_CODE
		</if>
     </trim>
     </sql>

	<!-- 주요지표 추이에 포함되는 테이블 -->
	<sql id="trnsitnListGroupTB">
		SELECT 
		AREA_NM
		, ABRV
		, KOREAN_NM
		, JIPYO_NM
		, round(sum(case when STDYY_DO=2004 then VAL else 0 end),0) as '2004'
		, round(sum(case when STDYY_DO=2005 then VAL else 0 end),0) as '2005'
		, round(sum(case when STDYY_DO=2006 then VAL else 0 end),0) as '2006'
		FROM (
		select A.STDYY_DO, A.ENTCLS, A.INDUTY_CODE, A.AREA_CODE, 'G01' AS JIPYO, '매출액' AS JIPYO_NM, SUM(ifnull(SELNG_AM,0)) AS VAL 
		, CASE WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) = 'C' THEN '제조업' WHEN SUBSTRING(A.INDUTY_CODE, 1, 1) != 'C' THEN '비제조업' end INDUTY_GUBUN
		, B.UPPER_CODE, B.AREA_NM, B.ABRV, B.LCLAS_CD, B.IND_CODE, B.KOREAN_NM
		from STS_ENTCLS A, (
		  select a.AREA_CODE, UPPER_CODE, AREA_NM, ABRV, LCLAS_CD
		  , IF( INDUTY_CODE = LCLAS_CD, LCLAS_CD,  CONCAT(LCLAS_CD, INDUTY_CODE))	IND_CODE
		  , case when b.LCLAS_CD = 'C' then concat(LCLAS_CD,INDUTY_CODE) else LCLAS_CD end as INDUTY_CODE 
		  , KOREAN_NM
		  from TB_AREA_DIV a, TB_IND_CD b
		  where a.`DIV`=2 and b.SE in ( 1, 2 ) 
		) B
		WHERE A.AREA_CODE = B.AREA_CODE
		AND A.INDUTY_CODE = B.INDUTY_CODE
		AND A.STDYY_DO BETWEEN 2004 AND 2006
		GROUP BY STDYY_DO
		) K
	</sql>
	
	
	<!-- ############## 주요지표현황(2015.01.13 강수종) ############# -->
	
	
	<!-- 전체(지역) 컬럼명 -->
	<sql id="incAllAreaColumn">
					, 'A' AS GBN_AS			<!-- 전체(지역)여부 -->
					, 'D' AS GBN_IS			<!-- 소계(제조/비제조)여부 -->
					, 'ALL' AS AREA_CODE
					, '전체' AS ABRV
					, 'ALL' AS UPPER_CODE
					, '전체' AS UPPER_NM
					, res.DTLCLFC_NO
					, res.DTLCLFC_NM
					, res.INDUTY_CODE
					, res.INDUTY_NM
					, res.INDUTY_SE
					, res.INDUTY_SE_NM
	</sql>
	
	<!-- 데이터 컬럼명 -->
	<sql id="incDataColumn">
					, 'D' AS GBN_AS			<!-- 전체(지역)여부 -->
					, 'D' AS GBN_IS			<!-- 소계(제조/비제조)여부 -->
					, res.AREA_CODE
					, res.ABRV
					, res.UPPER_CODE
					, res.UPPER_NM
					, res.DTLCLFC_NO
					, res.DTLCLFC_NM
					, res.INDUTY_CODE
					, res.INDUTY_NM
					, res.INDUTY_SE
					, res.INDUTY_SE_NM
	</sql>
	
	<!-- 주요지표현황 WHERE -->
	<sql id="incWhereForStatics">
		<if test="entcls.length > 1">
			WHERE ENTCLS IS NOT NULL
		</if>
	</sql>
	
	<!-- 주요지표현황 ORDER -->
	<sql id="incOrderForStatics">
		<if test="induty != null and induty != '' "><!-- 제조/비제조 -->
			tb2.INDUTY_SE, 
		</if>
		<if test="induty == '2'.toString() "><!-- 테마업종 -->
			tb2.DTLCLFC_NO, 
		</if>
		<if test="induty == '3'.toString() "><!-- 상세업종 -->
			tb2.INDUTY_CODE, 
		</if>
	</sql>
	
	<!-- 주요지표현황 GROUP -->
	<sql id="incGroupForStatics">
		<if test="chartY != 'area' ">
			<if test="induty != null and induty != '' "><!-- 제조/비제조 -->
				res.INDUTY_SE, 
			</if>
			<if test="induty == '2'.toString() "><!-- 테마업종 -->
				res.DTLCLFC_NO, 
			</if>
			<if test="induty == '3'.toString() "><!-- 상세업종 -->
				res.INDUTY_CODE, 
			</if>		
		</if>
	</sql>
	
	<!-- 업종/지역 조건 테이블 -->
	<sql id="incConditionTable">
						RIGHT JOIN		(
												SELECT		  areaOt.AREA_CODE
																, areaOt.ABRV
																, areaOt.UPPER_CODE
																, areaOt.UPPER_NM
																, thmaOt.INDUTY_CODE
																, thmaOt.DTLCLFC_NO
																, thmaOt.DTLCLFC_NM
																, thmaOt.INDUTY_SE
																, thmaOt.INDUTY_SE_NM
																, thmaOt.INDUTY_NM
												FROM		(										
																	SELECT		  area.AREA_CODE
																					, area.ABRV
																					, area.UPPER_CODE
																					, code.CODE_NM AS UPPER_NM
																	FROM		TB_AREA_DIV area, 
																					(
																						SELECT		CODE, CODE_NM
																						FROM		tb_cmmncode
																						WHERE		CODE_GROUP_NO = '57'
																							AND		USE_AT = 'Y'
																					) code
																	WHERE		area.`DIV` = '2'
																		AND		area.AREA_CODE != 'D99'
																		AND		area.UPPER_CODE = code.CODE
																	<if test="area != null and area != '' ">
																		AND
																		<if test="area == '1'.toString() "><!-- 권역별 -->
																				area.UPPER_CODE
																		</if>
																		<if test="area == '2'.toString() "><!-- 시도별 -->
																				area.AREA_CODE
																		</if>
																				IN
																		<foreach collection="areaVal" item="arav" index="idx" separator="," open="(" close=")">
																			#{arav}
																		</foreach>
																	</if>					) areaOt,
																(
																	SELECT		  thmi.INDUTY_CODE
																					, thdt.DTLCLFC_NO
																					, thdt.DTLCLFC_NM
																					, thdt.INDUTY_SE
																					, code.CODE_NM AS INDUTY_SE_NM
																					, indcd.KOREAN_NM AS INDUTY_NM
																	FROM		TB_THEMA_INDUTY thmi, TB_THEMA_DTLS thdt,
																					(
																						SELECT		CODE, CODE_NM 
																						FROM		tb_cmmncode
						 																WHERE		CODE_GROUP_NO = '74'
						 																	AND		USE_AT = 'Y'
																					) code,
																					(
																						SELECT		  IF(INDUTY_CODE = LCLAS_CD, LCLAS_CD, CONCAT(LCLAS_CD, INDUTY_CODE)) IND_CODE
																										, KOREAN_NM
																										, LCLAS_CD
																						FROM		TB_IND_CD
																						WHERE		LCLAS_CD = 'C' AND SE = '2'
																							<if test="induty == '3'.toString() ">		
																							AND		INDUTY_CODE
																									IN
																								<foreach collection="indutyVal" item="indtyv" index="idx" separator="," open="(" close=")">
																										SUBSTR(#{indtyv}, 2, 2)
																								</foreach>
																							</if>
						 																UNION ALL
						 																SELECT		  IF(INDUTY_CODE = LCLAS_CD, LCLAS_CD, CONCAT(LCLAS_CD, INDUTY_CODE)) IND_CODE
						 																				, KOREAN_NM
						 																				, LCLAS_CD
																						FROM		TB_IND_CD
																						WHERE		LCLAS_CD != 'C' AND SE = '1'
																							<if test="induty == '3'.toString() ">		
																							AND		INDUTY_CODE
																									IN
																								<foreach collection="indutyVal" item="indtyv" index="idx" separator="," open="(" close=")">
																									#{indtyv}
																								</foreach>
																							</if>				) indcd
																	WHERE		thmi.DTLCLFC_NO = thdt.DTLCLFC_NO
																		AND		thmi.MANAGE_SN = thdt.MANAGE_SN
																		AND		thdt.MANAGE_SN = '1'	
																		AND		code.CODE = thdt.INDUTY_SE
																		AND		thmi.INDUTY_CODE = indcd.IND_CODE
																		<if test="induty == '1'.toString() or induty == '2'.toString() ">		
																		AND
																			<if test="induty == '1'.toString() "><!-- 제조/비제조 -->
																					thdt.INDUTY_SE
																			</if>
																			<if test="induty == '2'.toString() "><!-- 테마업종 -->
																					 thdt.DTLCLFC_NO
																			</if>
																					IN
																			<foreach collection="indutyVal" item="indtyv" index="dix" separator="," open="(" close=")">
																				#{indtyv}
																			</foreach>
																		</if>				) thmaOt
											) tb2
							ON			 (tb1.INDUTY_CODE = tb2.INDUTY_CODE AND tb1.AREA_CODE = tb2.AREA_CODE)
	</sql>
	
	<!-- 업종/지역 조건 컬럼명 -->
	<sql id="incConditionColumn">
										, tb2.AREA_CODE
										, tb2.ABRV
										, tb2.UPPER_CODE
										, tb2.UPPER_NM
										, tb2.DTLCLFC_NO
										, tb2.DTLCLFC_NM									
										, tb2.INDUTY_CODE
										, tb2.INDUTY_NM
										, tb2.INDUTY_SE
										, tb2.INDUTY_SE_NM
	</sql>
	
	
	<!-- ############## 주요지표현황 ################## -->
	<!-- 주요지표 TB -->
	<sql id="incSelectForTBHistIdx">
						SELECT
										  IFNULL(tb1.ENTRPRS_CO, 0) AS ENTRPRS_CO
										, IFNULL(tb1.SELNG_AM, 0) AS SELNG_AM
										, IFNULL(tb1.ORDTM_LABRR_CO, 0) AS ORDTM_LABRR_CO
										, IFNULL(tb1.XPORT_AM_DOLLAR, 0) AS XPORT_AM_DOLLAR
										, IFNULL(tb1.XPORT_AM_WON, 0) AS XPORT_AM_WON
										, IFNULL(tb1.RSRCH_DEVLOP_CT, 0) AS RSRCH_DEVLOP_CT
										, IFNULL(tb1.CORAGE, 0) AS CORAGE
										, IFNULL(tb1.THSTRM_NTPF, 0) AS THSTRM_NTPF
										, IFNULL(tb1.BSN_PROFIT, 0) AS BSN_PROFIT
										, tb1.ENTCLS
										, tb1.ENTCLS_NM
										<include refid="incConditionColumn" />
						FROM		(
											SELECT		  sts.INDUTY_CODE, sts.AREA_CODE
															, sts.ENTCLS
															, sts.ENTRPRS_CO, sts.SELNG_AM, sts.ORDTM_LABRR_CO, sts.XPORT_AM_DOLLAR, sts.XPORT_AM_WON
															, sts.RSRCH_DEVLOP_CT , sts.CORAGE, sts.THSTRM_NTPF, sts.BSN_PROFIT
															, code.CODE_NM AS ENTCLS_NM
											FROM		STS_ENTCLS sts, tb_cmmncode code
											WHERE		sts.STDYY_DO = #{stdyy}
												AND		sts.ENTCLS IN
															<foreach collection="entcls" item="item" index="idx" separator="," open="(" close=")">
																#{item}
															</foreach>
												AND		code.CODE = sts.ENTCLS
												AND		code.CODE_GROUP_NO = '14'
										) tb1
										<include refid="incConditionTable" />
	</sql>

	<!-- 주요지표 최종 컬럼 -->
			
					
	<sql id="incIndxColumn">
			  rslt.GBN_AS
			, rslt.GBN_IS
			, rslt.AREA_CODE
			, rslt.ABRV
			, rslt.UPPER_CODE
			, rslt.UPPER_NM
			, rslt.DTLCLFC_NO
			, rslt.DTLCLFC_NM									
			, rslt.INDUTY_CODE
			, rslt.INDUTY_NM
			, rslt.INDUTY_SE
			, rslt.INDUTY_SE_NM
			, rslt.ENTCLS
			, rslt.ENTCLS_NM			
			,
		<foreach collection="indexVal" item="item"  index="idx" separator="," >
			<!-- 기업수, 매출액, 영업이익/영업이익률, 수출액/수출비중, 근로자수, R&D집약도, 당기순이익 -->
			<if test="index == '1'.toString() ">
				<if test="item == 'JP01' ">	  rslt.ENTRPRS_CO AS SUM_ENTRPRS_CO</if>
				<if test="item == 'JP02' ">	IFNULL(ROUND(rslt.SELNG_AM / 1000000000, 1), 0) AS SUM_SELNG_AM</if>
				<if test="item == 'JP03' ">	IFNULL(ROUND(rslt.BSN_PROFIT / 1000000000, 1), 0) AS SUM_BSN_PROFIT</if>
				<if test="item == 'JP03' ">	, IFNULL(ROUND(rslt.BSN_PROFIT / rslt.SELNG_AM * 100, 2), 0) AS SUM_BSN_PROFIT_RT</if>
				<if test="item == 'JP04' ">	IFNULL(ROUND(rslt.XPORT_AM_DOLLAR / 100000000, 1), 0) AS SUM_XPORT_AM_DOLLAR</if>
				<if test="item == 'JP04' ">	, IFNULL(ROUND(rslt.XPORT_AM_WON / rslt.SELNG_AM * 100, 2), 0) AS SUM_XPORT_AM_RT</if>
				<if test="item == 'JP05' ">	IFNULL(ROUND(rslt.ORDTM_LABRR_CO / 10000, 1), 0) AS SUM_ORDTM_LABRR_CO</if>
				<if test="item == 'JP06' ">	IFNULL(ROUND(rslt.RSRCH_DEVLOP_CT / rslt.SELNG_AM * 100, 2), 0) AS SUM_RSRCH_DEVLOP_RT</if>
				<if test="item == 'JP07' ">	IFNULL(ROUND(rslt.THSTRM_NTPF / 1000000000, 1), 0) AS SUM_THSTRM_NTPF</if>
			</if>
			<!-- 평균매출액, 평균영업이익/평균영업이익률, 평균수출액/평균수출비중, 평균근로자수, 평균R&D집약도, 평균당기순이익, 평균업력 -->
			<if test="index == '2'.toString() ">
				<if test="item == 'AJP01' ">	  rslt.ENTRPRS_CO AS SUM_ENTRPRS_CO</if>
				<if test="item == 'AJP02' ">	IFNULL(ROUND(rslt.SELNG_AM / 100000 / rslt.ENTRPRS_CO, 0), 0) AS AVG_SELNG_AM</if>
				<if test="item == 'AJP03' ">	IFNULL(ROUND(rslt.BSN_PROFIT / 100000 / rslt.ENTRPRS_CO, 0), 0) AS AVG_BSN_PROFIT</if>
				<if test="item == 'AJP03' ">	, IFNULL(ROUND(rslt.BSN_PROFIT / rslt.SELNG_AM / rslt.ENTRPRS_CO * 100, 2), 0) AS AVG_BSN_PROFIT_RT</if>
				<if test="item == 'AJP04' ">	IFNULL(ROUND(rslt.XPORT_AM_DOLLAR / 1000000 / rslt.ENTRPRS_CO, 0), 0) AS AVG_XPORT_AM_DOLLAR</if>
				<if test="item == 'AJP04' ">	, IFNULL(ROUND(rslt.XPORT_AM_WON / rslt.SELNG_AM / rslt.ENTRPRS_CO * 100, 2), 0) AS AVG_XPORT_AM_RT</if>
				<if test="item == 'AJP05' ">	IFNULL(ROUND(rslt.ORDTM_LABRR_CO / 100 / rslt.ENTRPRS_CO, 0), 0) AS AVG_ORDTM_LABRR_CO</if>
				<if test="item == 'AJP06' ">	IFNULL(ROUND(rslt.RSRCH_DEVLOP_CT / rslt.SELNG_AM / rslt.ENTRPRS_CO * 100, 2), 0) AS AVG_RSRCH_DEVLOP_RT</if>
				<if test="item == 'AJP07' ">	IFNULL(ROUND(rslt.THSTRM_NTPF / 100000 / rslt.ENTRPRS_CO, 0), 0) AS AVG_THSTRM_NTPF</if>
				<if test="item == 'AJP08' ">	IFNULL(ROUND(rslt.CORAGE / rslt.ENTRPRS_CO, 2), 0) AS AVG_CORAGE</if>
			</if>
		</foreach>
	</sql>

	<!-- 주요지표현황 데이터 목록 조회 -->
	<select id="selectIndxStaticsDataList" resultType="egovMap">
			<if test="area != null and area != '' and (chartY == '' || chartY == null) ">
	SELECT		/* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.selectIndxStaticsDataList */
					<include refid="incIndxColumn" />
	FROM		(
					SELECT
									  SUM(res.ENTRPRS_CO) AS ENTRPRS_CO
									, SUM(res.SELNG_AM) AS SELNG_AM
									, SUM(res.ORDTM_LABRR_CO) AS ORDTM_LABRR_CO
									, SUM(res.XPORT_AM_DOLLAR) AS XPORT_AM_DOLLAR
									, SUM(res.XPORT_AM_WON) AS XPORT_AM_WON
									, SUM(res.RSRCH_DEVLOP_CT) AS RSRCH_DEVLOP_CT
									, SUM(res.CORAGE) AS CORAGE
									, SUM(res.THSTRM_NTPF) AS THSTRM_NTPF
									, SUM(res.BSN_PROFIT) AS BSN_PROFIT
									, res.ENTCLS
									, res.ENTCLS_NM
									<include refid="incAllAreaColumn" />
				
					FROM		(
									<include refid="incSelectForTBHistIdx" />
									<include refid="incWhereForStatics" />
									<trim prefix="ORDER BY" suffixOverrides=",">
										<include refid="incOrderForStatics" />
									</trim>
									) res
						<trim prefix="GROUP BY" suffixOverrides=",">
							<include refid="incGroupForStatics" />
						</trim>
					) rslt
	UNION
					</if>
	SELECT		/* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.selectIndxStaticsDataList */
					<include refid="incIndxColumn" />
	FROM		(
					SELECT
									  SUM(res.ENTRPRS_CO) AS ENTRPRS_CO
									, SUM(res.SELNG_AM) AS SELNG_AM
									, SUM(res.ORDTM_LABRR_CO) AS ORDTM_LABRR_CO
									, SUM(res.XPORT_AM_DOLLAR) AS XPORT_AM_DOLLAR
									, SUM(res.XPORT_AM_WON) AS XPORT_AM_WON
									, SUM(res.RSRCH_DEVLOP_CT) AS RSRCH_DEVLOP_CT
									, SUM(res.CORAGE) AS CORAGE
									, SUM(res.THSTRM_NTPF) AS THSTRM_NTPF
									, SUM(res.BSN_PROFIT) AS BSN_PROFIT
									, res.ENTCLS
									, res.ENTCLS_NM
									<include refid="incDataColumn" />
					FROM		(
									<include refid="incSelectForTBHistIdx" />
									<include refid="incWhereForStatics" />
									<trim prefix="ORDER BY" suffixOverrides=",">
										<if test="area != null and area != '' ">
											tb2.UPPER_CODE, <!-- 권역별 -->
											tb2.AREA_CODE, <!-- 시도별 --> 
										</if>
										<include refid="incOrderForStatics" />
									</trim>
									) res
						<trim prefix="GROUP BY" suffixOverrides=",">
							<if test="chartY == 'area' ">
								<if test="area == '1'.toString() "><!-- 권역별 -->
									res.UPPER_CODE, 
								</if>
								<if test="area == '2'.toString() "><!-- 시도별 -->
									res.AREA_CODE, 
								</if>
							</if>
							<if test="chartY == null or chartY == '' ">
								<if test="area != null and area != '' ">
									res.UPPER_CODE, <!-- 권역별 -->
									res.AREA_CODE, <!-- 시도별 --> 
								</if>
							</if>
							<if test="entcls.length > 1">
									res.ENTCLS, <!-- 업군별 -->
							</if>
							<include refid="incGroupForStatics" />
						</trim>
	
					) rslt
	</select>
	
	<!-- ############## 주요지표현황(2015.01.13) ############# -->
	
	<!-- 주요지표 구간별현황 -->
	<select id="selectSctnStaticsDataList" resultType="egovMap">
	<if test="area != null and area != '' and (chartY == '' || chartY == null) ">
	SELECT		/* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.selectSctnStaticsDataList */
					<include refid="incSctnColumn" />
	FROM		(
					SELECT
									<if test="searchIndex == 'A'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7
									</if>
									<if test="searchIndex == 'B'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
									</if>
									<if test="searchIndex == 'C'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
									</if>
									<if test="searchIndex == 'D'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6
									</if>
									<if test="searchIndex == 'E'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6
									</if>
									<if test="searchIndex == 'F'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
										, SUM(res.SCTN1_1) AS SCTN1_1, SUM(res.SCTN2_1) AS SCTN2_1, SUM(res.SCTN3_1) AS SCTN3_1, SUM(res.SCTN4_1) AS SCTN4_1
										, SUM(res.SCTN5_1) AS SCTN5_1, SUM(res.SCTN6_1) AS SCTN6_1, SUM(res.SCTN7_1) AS SCTN7_1, SUM(res.SCTN8_1) AS SCTN8_1										
									</if>
									
									<include refid="incAllAreaColumn" />
				
					FROM		(
									<include refid="incSelectForTBSctn" />									
									<trim prefix="ORDER BY" suffixOverrides=",">
										<include refid="incOrderForStatics" />
									</trim>
									) res
						<trim prefix="GROUP BY" suffixOverrides=",">
							<include refid="incGroupForStatics" />
						</trim>
					) rslt
	UNION
					</if>
	SELECT		/* ProgramID=biz.tech.mapif.ps.PGPS0020Mapper.selectSctnStaticsDataList */
					<include refid="incSctnColumn" />
	FROM		(
					SELECT
									<if test="searchIndex == 'A'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7
									</if>
									<if test="searchIndex == 'B'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
									</if>
									<if test="searchIndex == 'C'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
									</if>
									<if test="searchIndex == 'D'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6
									</if>
									<if test="searchIndex == 'E'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6
									</if>
									<if test="searchIndex == 'F'.toString()">
										SUM(res.SCTN1) AS SCTN1, SUM(res.SCTN2) AS SCTN2, SUM(res.SCTN3) AS SCTN3, SUM(res.SCTN4) AS SCTN4
										, SUM(res.SCTN5) AS SCTN5, SUM(res.SCTN6) AS SCTN6, SUM(res.SCTN7) AS SCTN7, SUM(res.SCTN8) AS SCTN8
										, SUM(res.SCTN1_1) AS SCTN1_1, SUM(res.SCTN2_1) AS SCTN2_1, SUM(res.SCTN3_1) AS SCTN3_1, SUM(res.SCTN4_1) AS SCTN4_1
										, SUM(res.SCTN5_1) AS SCTN5_1, SUM(res.SCTN6_1) AS SCTN6_1, SUM(res.SCTN7_1) AS SCTN7_1, SUM(res.SCTN8_1) AS SCTN8_1										
									</if>
									  									  
									<include refid="incDataColumn" />
					FROM		(
									<include refid="incSelectForTBSctn" />									
									<trim prefix="ORDER BY" suffixOverrides=",">
										<if test="area != null and area != '' ">
											tb2.UPPER_CODE, <!-- 권역별 -->
											tb2.AREA_CODE, <!-- 시도별 --> 
										</if>
										<include refid="incOrderForStatics" />
									</trim>
									) res
						<trim prefix="GROUP BY" suffixOverrides=",">
							<if test="chartY == 'area' ">
								<if test="area == '1'.toString() "><!-- 권역별 -->
									res.UPPER_CODE, 
								</if>
								<if test="area == '2'.toString() "><!-- 시도별 -->
									res.AREA_CODE, 
								</if>
							</if>
							<if test="chartY == null or chartY == '' ">
								<if test="area != null and area != '' ">
									res.UPPER_CODE, <!-- 권역별 -->
									res.AREA_CODE, <!-- 시도별 --> 
								</if>
							</if>							
							<include refid="incGroupForStatics" />
						</trim>
	
					) rslt
	</select>
	
	<sql id="incSctnColumn">
			  rslt.GBN_AS
			, rslt.GBN_IS
			, rslt.AREA_CODE
			, rslt.ABRV
			, rslt.UPPER_CODE
			, rslt.UPPER_NM
			, rslt.DTLCLFC_NO
			, rslt.DTLCLFC_NM									
			, rslt.INDUTY_CODE
			, rslt.INDUTY_NM
			, rslt.INDUTY_SE
			, rslt.INDUTY_SE_NM				
			,
		<if test="searchIndex == 'A'.toString()">
			rslt.SCTN1, rslt.SCTN2, rslt.SCTN3, rslt.SCTN4, rslt.SCTN5, rslt.SCTN6, rslt.SCTN7
			, rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 + rslt.SCTN7 AS SCTN_SUM
		</if>
		<if test="searchIndex == 'B'.toString()">
			rslt.SCTN1, rslt.SCTN2, rslt.SCTN3, rslt.SCTN4, rslt.SCTN5, rslt.SCTN6, rslt.SCTN7, rslt.SCTN8
			, rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 + rslt.SCTN7 + rslt.SCTN8 AS SCTN_SUM
		</if>
		<if test="searchIndex == 'C'.toString()">
			rslt.SCTN1, rslt.SCTN2, rslt.SCTN3, rslt.SCTN4, rslt.SCTN5, rslt.SCTN6, rslt.SCTN7, rslt.SCTN8
			, rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 + rslt.SCTN7 + rslt.SCTN8 AS SCTN_SUM
		</if>
		<if test="searchIndex == 'D'.toString()">
			rslt.SCTN1, rslt.SCTN2, rslt.SCTN3, rslt.SCTN4, rslt.SCTN5, rslt.SCTN6
			, rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 AS SCTN_SUM
		</if>
		<if test="searchIndex == 'E'.toString()">
			rslt.SCTN1, rslt.SCTN2, rslt.SCTN3, rslt.SCTN4, rslt.SCTN5, rslt.SCTN6
			, rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 AS SCTN_SUM
		</if>
		<if test="searchIndex == 'F'.toString()">
			IFNULL(ROUND(rslt.SCTN1_1/rslt.SCTN1*100, 2), 0) AS SCTN1
			, IFNULL(ROUND(rslt.SCTN2_1/rslt.SCTN2*100, 2), 0) AS SCTN2
			, IFNULL(ROUND(rslt.SCTN3_1/rslt.SCTN3*100, 2), 0) AS SCTN3
			, IFNULL(ROUND(rslt.SCTN4_1/rslt.SCTN4*100, 2), 0) AS SCTN4
			, IFNULL(ROUND(rslt.SCTN5_1/rslt.SCTN5*100, 2), 0) AS SCTN5
			, IFNULL(ROUND(rslt.SCTN6_1/rslt.SCTN6*100, 2), 0) AS SCTN6
			, IFNULL(ROUND(rslt.SCTN7_1/rslt.SCTN7*100, 2), 0) AS SCTN7
			, IFNULL(ROUND(rslt.SCTN8_1/rslt.SCTN8*100, 2), 0) AS SCTN8
			, IFNULL(ROUND((rslt.SCTN1_1 + rslt.SCTN2_1 + rslt.SCTN3_1 + rslt.SCTN4_1 + rslt.SCTN5_1 + rslt.SCTN6_1 + rslt.SCTN7_1 + rslt.SCTN8_1) /
			(rslt.SCTN1 + rslt.SCTN2 + rslt.SCTN3 + rslt.SCTN4 + rslt.SCTN5 + rslt.SCTN6 + rslt.SCTN7 + rslt.SCTN8) * 100, 2), 0) AS SCTN_SUM			
		</if>
	</sql>
	
	<sql id="incSelectForTBSctn">
						SELECT			
										<if test="searchIndex == 'A'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6, IFNULL(tb1.SCTN7, 0) AS SCTN7
										</if>
										<if test="searchIndex == 'B'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6, IFNULL(tb1.SCTN7, 0) AS SCTN7, IFNULL(tb1.SCTN8, 0) AS SCTN8
										</if>
										<if test="searchIndex == 'C'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6, IFNULL(tb1.SCTN7, 0) AS SCTN7, IFNULL(tb1.SCTN8, 0) AS SCTN8
										</if>
										<if test="searchIndex == 'D'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6
										</if>
										<if test="searchIndex == 'E'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6
										</if>
										<if test="searchIndex == 'F'.toString()">
											IFNULL(tb1.SCTN1, 0) AS SCTN1, IFNULL(tb1.SCTN2, 0) AS SCTN2, IFNULL(tb1.SCTN3, 0) AS SCTN3, IFNULL(tb1.SCTN4, 0) AS SCTN4,
											IFNULL(tb1.SCTN5, 0) AS SCTN5, IFNULL(tb1.SCTN6, 0) AS SCTN6, IFNULL(tb1.SCTN7, 0) AS SCTN7, IFNULL(tb1.SCTN8, 0) AS SCTN8,
											IFNULL(tb1.SCTN1_1, 0) AS SCTN1_1, IFNULL(tb1.SCTN2_1, 0) AS SCTN2_1, IFNULL(tb1.SCTN3_1, 0) AS SCTN3_1, IFNULL(tb1.SCTN4_1, 0) AS SCTN4_1,
											IFNULL(tb1.SCTN5_1, 0) AS SCTN5_1, IFNULL(tb1.SCTN6_1, 0) AS SCTN6_1, IFNULL(tb1.SCTN7_1, 0) AS SCTN7_1, IFNULL(tb1.SCTN8_1, 0) AS SCTN8_1																			
										</if>
										  
										<include refid="incConditionColumn" />
						FROM		(
											SELECT		  INDUTY_CODE, AREA_CODE,
											<if test="searchIndex == 'A'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6, IFNULL(SCTN7, 0) AS SCTN7												
												FROM STS_RND_SCTN
											</if>
											<if test="searchIndex == 'B'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6, IFNULL(SCTN7, 0) AS SCTN7, IFNULL(SCTN8, 0) AS SCTN8												
												FROM STS_INDUTY_SCTN
											</if>
											<if test="searchIndex == 'C'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6, IFNULL(SCTN7, 0) AS SCTN7, IFNULL(SCTN8, 0) AS SCTN8												
												FROM STS_XPORT_SCTN
											</if>
											<if test="searchIndex == 'D'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6
												FROM STS_LABRR_SCTN
											</if>
											<if test="searchIndex == 'E'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6												
												FROM STS_CORAGE_SCTN
											</if>
											<if test="searchIndex == 'F'.toString()">
												IFNULL(SCTN1, 0) AS SCTN1, IFNULL(SCTN2, 0) AS SCTN2, IFNULL(SCTN3, 0) AS SCTN3, IFNULL(SCTN4, 0) AS SCTN4,
												IFNULL(SCTN5, 0) AS SCTN5, IFNULL(SCTN6, 0) AS SCTN6, IFNULL(SCTN7, 0) AS SCTN7, IFNULL(SCTN8, 0) AS SCTN8,
												IFNULL(SCTN1_1, 0) AS SCTN1_1, IFNULL(SCTN2_1, 0) AS SCTN2_1, IFNULL(SCTN3_1, 0) AS SCTN3_1, IFNULL(SCTN4_1, 0) AS SCTN4_1,
												IFNULL(SCTN5_1, 0) AS SCTN5_1, IFNULL(SCTN6_1, 0) AS SCTN6_1, IFNULL(SCTN7_1, 0) AS SCTN7_1, IFNULL(SCTN8_1, 0) AS SCTN8_1												
												FROM STS_SELNG_RND_SCTN										
											</if>				
											WHERE		STDYY_DO = #{stdyy}
												AND		ENTCLS = #{entcls}												
										) tb1
										<include refid="incConditionTable" />
	</sql>
</mapper>

